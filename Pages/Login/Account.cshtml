@page
@model FoodManagement.Pages.Login.AccountModel
@{
    ViewData["Title"] = "Thông tin tài khoản";
    var a = Model.Admin;
}

<div class="container py-3">
    <div class="card">
        <div class="card-body">
            @if (!string.IsNullOrEmpty(Model.Message))
            {
                <div id="alert" class="alert alert-success">@Model.Message</div>
            }
            @if (a == null)
            {
                <div class="alert alert-warning">Không tìm thấy thông tin tài khoản.</div>
            }
            else
            {
                <div class="row g-3">
                    <div class="col-md-3 text-center">
                        <img src="@(a.avatar ?? Url.Content("~/assets/img/avatars/account.png"))"
                             alt="avatar"
                             class="rounded-circle"
                             style="width:120px;height:120px;object-fit:cover;" />
                    </div>
                    <div class="col-md-9">
                        <h4 class="mb-1">@($"{a.lastName} {a.firstName}".Trim())</h4>
                        <p class="text-muted mb-1">@a.username</p>
                        <div class="row mt-3">
                            <div class="col-sm-6">
                                <dl class="row">
                                    <dt class="col-5">Email</dt>
                                    <dd class="col-7">@(!string.IsNullOrEmpty(a.email) ? a.email : "-")</dd>

                                    <dt class="col-5">Số điện thoại</dt>
                                    <dd class="col-7">@(!string.IsNullOrEmpty(a.phone) ? a.phone : "-")</dd>

                                    <dt class="col-5">Quyền</dt>
                                    <dd class="col-7">@a.role</dd>
                                </dl>
                            </div>
                            <div class="col-sm-6">
                                <dl class="row">
                                    <dt class="col-5">Trạng thái</dt>
                                    <dd class="col-7">@((a.isActive) ? "Hoạt động" : "Không hoạt động")</dd>

                                    <dt class="col-5">Lần đăng nhập</dt>
                                    <dd class="col-7">@((a.LastLoginAt == default) ? "-" : a.LastLoginAt.ToLocalTime().ToString("dd/MM/yyyy HH:mm"))</dd>

                                    <dt class="col-5">Ngày tạo</dt>
                                    <dd class="col-7">@((a.createdAt == default) ? "-" : a.createdAt.ToLocalTime().ToString("dd/MM/yyyy HH:mm"))</dd>
                                </dl>
                            </div>
                        </div>

                        <div class="mt-3">
                            <a class="btn btn-warning me-2" asp-page="/Accounts/Admin/EditAdmin" asp-route-id="@a.id">Sửa thông tin</a>
                            <a class="btn btn-outline-secondary" asp-page="/Login/ChangePassword">Đổi mật khẩu</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function hideAlertsOnce() {
            document.querySelectorAll('.alert').forEach(alert => {
                alert.classList.add('fade');
                setTimeout(() => {
                    if (alert && alert.parentNode) alert.parentNode.removeChild(alert);
                }, 500);
            });
        }
        setTimeout(hideAlertsOnce, 3000);
    </script>
}